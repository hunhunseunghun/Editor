# 🚀 Vercel 배포 시 진행사항 TODO 리스트

## 📋 사전 준비 단계

### ✅ 환경 변수 설정

- [ ] **MONGODB_URI** 설정 (MongoDB Atlas 연결 문자열)
- [ ] **MONGODB_DATABASE** 설정 (데이터베이스 이름)
- [ ] **NEXTAUTH_SECRET** 설정 (인증 시크릿 키)
- [ ] **NEXTAUTH_URL** 설정 (프로덕션 URL)
- [ ] **GITHUB_ID** 설정 (GitHub OAuth ID)
- [ ] **GITHUB_SECRET** 설정 (GitHub OAuth Secret)
- [ ] **ADMIN_TOKEN** 설정 (관리자 API 토큰)

### ✅ Vercel 프로젝트 설정

- [ ] Vercel CLI 설치 및 로그인
- [ ] 프로젝트 연결 (`vercel link`)
- [ ] 환경 변수 업로드 (`vercel env pull`)
- [ ] 도메인 설정 (필요시)

## 🔄 배포 단계

### ✅ 코드 배포

- [ ] 메인 브랜치에 최신 코드 푸시
- [ ] Vercel 자동 배포 트리거 확인
- [ ] 빌드 로그 확인 (에러 없음)
- [ ] 배포 완료 확인

### ✅ 배포 후 검증

- [ ] 프로덕션 URL 접속 테스트
- [ ] 기본 페이지 로딩 확인
- [ ] 인증 기능 테스트
- [ ] 에디터 기능 테스트

## 🗄️ 데이터베이스 설정 단계

### ✅ MongoDB Atlas 설정

- [ ] MongoDB Atlas 클러스터 상태 확인
- [ ] 네트워크 액세스 설정 (Vercel IP 허용)
- [ ] 데이터베이스 사용자 권한 확인
- [ ] 연결 문자열 유효성 검증

### ✅ 인덱스 생성 (필수!)

- [ ] **방법 1: API 엔드포인트 호출**

  ```bash
  curl -X POST https://your-app.vercel.app/api/admin/indexes \
    -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
  ```

- [ ] **방법 2: Vercel Dashboard에서 실행**

  - Vercel Dashboard → Functions → create-trash-indexes → Invoke

- [ ] **방법 3: Vercel CLI 사용**
  ```bash
  vercel functions invoke create-trash-indexes --prod
  ```

### ✅ 인덱스 생성 확인

- [ ] 인덱스 생성 성공 로그 확인
- [ ] 인덱스 상태 확인 API 호출
  ```bash
  curl -X GET https://your-app.vercel.app/api/admin/indexes \
    -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
  ```
- [ ] 생성된 인덱스 목록 검증

## 🧪 기능 테스트 단계

### ✅ 핵심 기능 테스트

- [ ] 사용자 로그인/회원가입
- [ ] 문서 생성/편집/저장
- [ ] 폴더 생성/이동/삭제
- [ ] 트리 구조 동작 확인
- [ ] 실시간 동기화 확인

### ✅ 휴지통 기능 테스트

- [ ] 문서 삭제 → 휴지통 이동 확인
- [ ] 폴더 삭제 → 휴지통 이동 확인
- [ ] 휴지통 조회 성능 확인
- [ ] 복원 기능 테스트
- [ ] 영구 삭제 기능 테스트

### ✅ 성능 테스트

- [ ] 페이지 로딩 속도 확인
- [ ] 대용량 문서 처리 테스트
- [ ] 동시 사용자 시나리오 테스트
- [ ] 네트워크 지연 상황 테스트

## 🔧 문제 해결 단계

### ✅ 로그 확인

- [ ] Vercel Dashboard → Functions → Logs 확인
- [ ] MongoDB Atlas 로그 확인
- [ ] 브라우저 개발자 도구 에러 확인
- [ ] 네트워크 요청 상태 확인

### ✅ 일반적인 문제들

- [ ] CORS 에러 해결 (필요시)
- [ ] 환경 변수 누락 확인
- [ ] 데이터베이스 연결 타임아웃 확인
- [ ] 인덱스 생성 실패 시 재시도

## 📊 모니터링 설정

### ✅ 성능 모니터링

- [ ] Vercel Analytics 활성화
- [ ] MongoDB Atlas 성능 모니터링 설정
- [ ] 에러 추적 도구 설정 (Sentry 등)
- [ ] 사용자 행동 분석 도구 설정

### ✅ 알림 설정

- [ ] 배포 성공/실패 알림 설정
- [ ] 에러 발생 시 알림 설정
- [ ] 성능 저하 시 알림 설정
- [ ] 데이터베이스 연결 문제 알림 설정

## 🔒 보안 검증

### ✅ 보안 설정 확인

- [ ] HTTPS 강제 리다이렉트 확인
- [ ] 환경 변수 노출 여부 확인
- [ ] API 엔드포인트 보안 확인
- [ ] 인증 토큰 보안 확인

### ✅ 권한 설정 확인

- [ ] 관리자 API 접근 권한 확인
- [ ] 데이터베이스 사용자 권한 확인
- [ ] 파일 업로드 권한 확인
- [ ] 사용자별 데이터 격리 확인

## 📝 문서화

### ✅ 배포 문서 업데이트

- [ ] 배포 절차 문서 업데이트
- [ ] 환경 변수 목록 문서화
- [ ] 문제 해결 가이드 작성
- [ ] 롤백 절차 문서화

### ✅ 팀 공유

- [ ] 배포 완료 알림 팀 공유
- [ ] 변경사항 요약 공유
- [ ] 테스트 결과 공유
- [ ] 다음 배포 계획 공유

## 🎯 완료 체크리스트

### ✅ 최종 확인사항

- [ ] 모든 기능 정상 동작 확인
- [ ] 성능 지표 정상 범위 확인
- [ ] 보안 설정 완료 확인
- [ ] 모니터링 도구 정상 동작 확인
- [ ] 팀원들에게 배포 완료 알림
- [ ] 다음 배포 준비 시작

---

## 🚨 중요 주의사항

### ⚠️ 인덱스 생성은 반드시 배포 후 즉시 실행해야 합니다!

- 휴지통 기능이 제대로 동작하려면 인덱스가 필수
- 인덱스 없이는 성능이 크게 저하됨
- 사용자가 휴지통을 사용하기 전에 반드시 생성 완료

### ⚠️ 환경 변수 보안

- 민감한 정보는 절대 코드에 하드코딩하지 않음
- Vercel Dashboard에서 안전하게 관리
- 정기적으로 토큰 갱신

### ⚠️ 롤백 준비

- 배포 전 이전 버전 백업
- 롤백 절차 미리 준비
- 긴급 상황 시 빠른 대응 가능하도록 준비

---
